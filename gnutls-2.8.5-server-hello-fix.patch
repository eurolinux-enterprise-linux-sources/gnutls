diff -ur gnutls-2.8.5.orig/lib/gnutls_handshake.c gnutls-2.8.5/lib/gnutls_handshake.c
--- gnutls-2.8.5.orig/lib/gnutls_handshake.c	2009-11-02 11:30:39.000000000 +0100
+++ gnutls-2.8.5/lib/gnutls_handshake.c	2014-05-28 13:18:47.586703411 +0200
@@ -1518,7 +1518,7 @@
   DECR_LEN (len, 1);
   session_id_len = data[pos++];
 
-  if (len < session_id_len)
+  if (len < session_id_len || session_id_len > TLS_MAX_SESSION_ID_SIZE)
     {
       gnutls_assert ();
       return GNUTLS_E_UNSUPPORTED_VERSION_PACKET;
